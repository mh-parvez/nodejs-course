import jwt from "jsonwebtoken";

const clientId = "YOUR_CLIENT_ID";

const token =
  "eyJhbGciOiJSUzI1NiIsImtpZCI6IjIzZjdhMzU4Mzc5NmY5NzEyOWU1NDE4ZjliMjEzNmZjYzBhOTY0NjIiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI1OTQ1NTU2OTc2MTMtMThwM3MybzZobDdtdmMzZ2owbzJhMmJnN2IyN3RqOW0uYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiI1OTQ1NTU2OTc2MTMtMThwM3MybzZobDdtdmMzZ2owbzJhMmJnN2IyN3RqOW0uYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMTQzMjAwNTk1MTU0ODgwNjc0NDIiLCJlbWFpbCI6InByb2NvZHJyQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhdF9oYXNoIjoiSFV1YUZiU2tQTEE1UTVUUnZ2aDcxdyIsIm5hbWUiOiJQcm9Db2RyciIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NKWThEX2kybWxRMVpXZ1htMW5XNHoyQm9JZG5Hdk5qdmFPNXB2OWZGc0lxWktoZmFKUj1zOTYtYyIsImdpdmVuX25hbWUiOiJQcm9Db2RyciIsImlhdCI6MTc0NTg5NTMwNSwiZXhwIjoxNzQ1ODk4OTA1fQ.H6rxa_TUo6ciWCGXZTebHW7hmrN6ZMfsihCfWHa4rYHz-wsfwAZCcyEfQ3CpfKJRHeTrwyHA03FveoJj0iArIGfVyGHkn7mFd5KGgfWFvH-BslE3E_Xy7gXcXY0fb9puVntX8qkqTLcFP7oKuAxQ3I5I2ua8SaLXNAPoKp3_pA84r9erdw_vAyTluIVsRHWowyA9ZvuVU2cnFoscuRnKhlGR3zJT2LEldzzydxdcqxeEFoT-rDGqW597Bs8kb69PnLxfJiffPBVCOFKV-dWAi1nWqQEWf6Lm1l8Cxe5oM5dzT1Cja2l8oOjWPKsHha9HOa1WCypUKChpqmPv_QarYg";
const publicKey = `-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAjb7Wtq9aDMpiXvHGCB5n
rfAS2UutDEkSbK16aDtDhbYJhDWhd7vqWhFbnP0C/XkSxsqWJoku69y49EzgabEi
UMf0q3X5N0pNvV64krviH2m9uLnyGP5GMdwZpjTXARK9usGgYZGuWhjfgTTvooKD
UdqVQYvbrmXlblkM6xjbA8GnShSaOZ4AtMJCjWnaN/UaMD/vAXvOYj4SaefDMSlS
oiI46yipFdggfoIV8RDg1jeffyre/8DwOWsGz7b2yQrL7grhYCvoiPrybKmViXqu
+17LTIgBw6TDk8EzKdKzm33/LvxU7AKs3XWW/NvZ4WCPwp4gr7uw6RAkdDX/ZAn0
TQIDAQAB
-----END PUBLIC KEY-----`;

const data = jwt.verify(token, publicKey, {
  algorithms: ["RS256"],
});

console.log(data.aud === clientId);

console.log(data);
